var export_settings={};export_settings.groups={};export_settings.dials={};export_settings.settings={};function exportData(){speeddial.storage.open();speeddial.storage.getGroups(function(tx,rs){for(var i=0;i<rs.rows.length;i++){export_settings.groups[i]=rs.rows.item(i)}speeddial.storage.getAllItems(function(tx,rs){for(var i=0;i<rs.rows.length;i++){export_settings.dials[i]=rs.rows.item(i)}for(var i=0;i<window.localStorage.length;i++){key=localStorage.key(i);if(speeddial.storage.filtersync(key)){value=localStorage.getItem(localStorage.key(i));export_settings.settings[key]=value}}$("#export textarea").val(JSON.stringify(export_settings,null,2));$("#export").show();$("#export #download").unbind().on("click",function(){window.open("data:Application/octet-stream,"+encodeURIComponent(JSON.stringify(export_settings,null,2)))})})})}function import_settings(){var settings=$("#import_textarea").val();if(settings){try{var theJson=jQuery.parseJSON(settings)}catch(e){show_message("Sorry, this doesn't seem like valid JSON. Please use JSON validator to fix it.",true,5e3);return false}show_message("Importing ...",true,16e3);b.import_settings(settings,function(){setTimeout(function(){show_message("Import successfull")},2e3)})}}function moveSettings(direction){$("#import,#export").hide();if(direction=="import"){$("#import").show();$("#import_textarea").val("")}else if(direction=="export"){exportData()}}