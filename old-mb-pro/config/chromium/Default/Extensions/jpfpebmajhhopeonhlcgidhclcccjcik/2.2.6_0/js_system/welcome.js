var domains=[];function recommend_website(item){if(!domains[getHostname(item.url)]&&item.url.indexOf("http://")!="0"&&item.url.indexOf("https://")!="0"){return}if(!item.logo&&suggestThumbnail(item.url)==""){return}if(!item.logo){item.logo=suggestThumbnail(item.url)}if(domains.indexOf(getHostname(item.url))>-1){return}domains.push(getHostname(item.url));var website=document.createElement("label");var link=document.createElement("a");var checkbox=document.createElement("input");var icon=document.createElement("div");checkbox.setAttribute("type","checkbox");checkbox.setAttribute("url",item.url);checkbox.setAttribute("title",item.title);checkbox.setAttribute("thumbnail",item.logo);icon.style.backgroundImage="url("+item.logo+")";icon.setAttribute("class","favicon");link.innerHTML=item.title;website.setAttribute("class","website");website.appendChild(icon);website.appendChild(checkbox);website.appendChild(link);$("#most_visited_websites").append(website)}function calcTrends(){domains=[];chrome.topSites.get(function(historyItems){var max_to_recommend=18;for(var i=0;i<historyItems.length;++i){var item=historyItems[i];recommend_website(item)}var i=0;while(domains.length<max_to_recommend){var item=app.suggestedWebsites[i];recommend_website(item);i++}})}$(function(){background_init();welcome(1)});function welcome(id){if(id==1){document.body.classList.add("body--initial-screen")}else{document.body.classList.remove("body--initial-screen")}if(id>1){localStorage["firstTime"]="false"}if(id==2){}$(".welcome").hide();$("#welcome-"+id).show();if(id==10){$("#most_visited_websites").html("");calcTrends()}}function finish(){top.location.href=chrome.extension.getURL("newtab.html")}function importSelected(){var i=0;var count=$("#most_visited_websites input:checked").size();var created=0;if(count>0){$("#most_visited_websites input:checked").each(function(){i++;var $this=$(this);insert=new Array;insert["url"]=$this.attr("url");insert["title"]=$this.attr("title");insert["thumbnail"]=$this.attr("thumbnail");insert["ts_created"]=Math.round((new Date).getTime()/1e3);insert["visits"]=0;insert["visits_morning"]=0;insert["visits_afternoon"]=0;insert["visits_evening"]=0;insert["visits_night"]=0;insert["position"]=i;insert["idgroup"]=0;speeddial.storage.addItem(insert,function(){created++;if(created==count){}})})}welcome(99)}function suggestThumbnail(url){for(var i in app.suggestedWebsites){if(url.indexOf(app.suggestedWebsites[i].url)>-1)return app.suggestedWebsites[i].logo}return""}$(function(){$(document).bind("change","input[type=checkbox]",function(e){if(e.target.checked){$(e.target).parents(".website").addClass("selected")}else{$(e.target).parents(".website").removeClass("selected")}});$("form.sign-up").on("submit",function(e){e.preventDefault();var form=$("form.sign-up");var email=form.find("#signup-email").val();var password=form.find("#signup-password").val();var user={email:email,password:password};form.find(".form-errors").text("").hide();if(!email||email==""){form.find(".form-errors").text(i18n("error_enter_email")).show()}else if(!password||password==""){form.find(".form-errors").text(i18n("error_enter_password")).show()}else if(email!=""&&password!=""){form.find("button").attr("disabled",true);b.sign_up(user,function(response){if(response.error){}else if(response.status=="ok"){localStorage["options.sync.username"]=response.email}finish()})}});$(".click-welcome").click(function(){welcome($(this).data("screen"))});$(".click-import-selected").click(function(){importSelected()});$(".click-welcome-finish").click(function(){finish()})});var topSites=[{url:"http://www.youtube.com",image:"http://i.imgur.com/66Zr5MP.png",title:"Youtube"},{url:"https://www.google.com",image:"http://i.imgur.com/3WdnTuH.png",title:"Google"},{url:"https://mail.google.com",image:"http://farm9.staticflickr.com/8113/8660321326_d1ca08f601_o.png",title:"Gmail"},{url:"https://www.facebook.com",image:"http://i.imgur.com/5azi974.png",title:"Facebook"},{url:"https://twitter.com",image:"http://i.imgur.com/gahUxV6.png",title:"Twitter"},{url:"http://www.amazon.com",image:"http://i.imgur.com/9KcsUAc.png",title:"Amazon"},{url:"https://plus.google.com",image:"http://i.imgur.com/Jqk26dk.png",title:"Google+"},{url:"https://drive.google.com",image:"http://farm9.staticflickr.com/8124/8660297258_6291ac830d_o.png",title:"Google Drive"},{url:"https://play.google.com",image:"http://i.imgur.com/jrTFxSP.png",title:"Google Play"},{url:"https://www.paypal.com",image:"http://i.imgur.com/OYeNVmX.png",title:"Paypal"},{url:"https://pinterest.com/",image:"http://i.imgur.com/721RaEa.png",title:"Pinterest"},{url:"http://www.reddit.com",image:"http://farm9.staticflickr.com/8114/8659196901_a5e301b242_o.png",title:"Reddit"},{url:"https://www.dropbox.com",image:"http://i.imgur.com/4L6Yzt1.png",title:"Dropbox"},{url:"http://www.producthunt.com",image:"http://i.imgur.com/OPXFVNS.png",title:"Product Hunt"},{url:"https://www.spotify.com",image:"http://i.imgur.com/k9uFlcM.png",title:"Spotify"},{url:"https://github.com",image:"http://i.imgur.com/BbAjlTn.png",title:"Github"},{url:"https://github.com",image:"http://i.imgur.com/Fk5t9Om.png",title:"Github"},{url:"http://dribbble.com",image:"http://i.imgur.com/DTTaFWh.png",title:"Dribbble"},{url:"http://www.wikipedia.org",image:"http://farm6.static.flickr.com/5030/5613126220_3f11312ec5_o.png",title:"Wikipedia"},{url:"http://www.linkedin.com",image:"http://i.imgur.com/aZIsFYs.png",title:"Linked In"},{url:"http://www.bbc.co.uk",image:"http://farm6.static.flickr.com/5148/5612548351_9411e74716_o.png",title:"BBC"},{url:"http://www.ebay.com",image:"http://i.imgur.com/dgP5xHs.png",title:"Ebay"},{url:"http://lifehacker.com",image:"http://i.imgur.com/dd0ms91.png",title:"Lifehacker"},{url:"http://www.aol.com",image:"http://i.imgur.com/tsgUoxB.png",title:"Aol"},{url:"http://www.apple.com",image:"http://farm6.static.flickr.com/5063/5612547145_625055a1c6_o.png",title:"Apple"},{url:"http://www.deviantart.com",image:"http://farm6.static.flickr.com/5310/5612547429_851d9333bc_o.gif",title:"Deviantart"},{url:"http://www.theverge.com",image:"http://i.imgur.com/ase4t7o.png",title:"The Verge"}];var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-1391454-40"]);_gaq.push(["_trackPageview"]);(function(){var ga=document.createElement("script");ga.type="text/javascript";ga.async=true;ga.src="https://ssl.google-analytics.com/ga.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga,s)})();