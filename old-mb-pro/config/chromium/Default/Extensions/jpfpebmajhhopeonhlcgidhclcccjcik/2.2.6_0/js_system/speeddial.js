var app=app||{};var controller;$(function(){$("#quick-settings-icon").click(function(){app.optionsController.open()});$(".click-open").click(function(){openInCurrent($(this).data("url"))});if(getValue("options.sync.username")&&getValue("options.sync.password")){$("html").addClass("premium-user")}else{$("html").addClass("free-user")}if(getValue("options.darkTheme")==1){document.body.classList.add("theme--dark")}});$.ajaxSetup({cache:false});if(localStorage["options.apps.show"]==1||localStorage["options.sidebar.showApps"]){document.write('<script type="text/javascript" charset="utf-8" src="'+chrome.extension.getURL("js_system/apps.js")+'"><\/script>')}if(localStorage["options.sidebar"]==1){document.write('<script src="'+chrome.extension.getURL("js_system/sidebar.js")+'"><\/script>');if(localStorage["options.sidebar.showBookmarks"]==1){document.write('<script src="'+chrome.extension.getURL("js_system/sidebar.bookmarks.js")+'"><\/script>')}if(localStorage["options.sidebar.showHistory"]==1){document.write('<script src="'+chrome.extension.getURL("js_system/sidebar.history.js")+'"><\/script>')}}var isCtrl=false;$(window).keydown(function(e){if(e.ctrlKey){isCtrl=true}}).keyup(function(e){isCtrl=false});if(localStorage["firstTime"]!="false"){chrome.tabs.getSelected(null,function(tab){chrome.tabs.update(tab.id,{url:chrome.extension.getURL("welcome.html")})})}function openInCurrent(url){chrome.tabs.getSelected(null,function(tab){chrome.tabs.update(tab.id,{url:url})})}function openInNew(url){speeddial.storage.trackVisits(url);chrome.tabs.create({url:url,selected:false})}function openurl(url,e){if(localStorage["options.alwaysNewTab"]=="1"&&(isCtrl==true||e.which==2)){openInCurrent(url);e.preventDefault();e.stopPropagation()}else if(localStorage["options.alwaysNewTab"]=="1"){chrome.tabs.create({url:url,selected:true});e.preventDefault()}}function getThumbnail(url,showInfoWarning){chrome.tabs.getSelected(null,function(tab){speeddial.storage.removeThumbnail(url);localStorage["requestThumbnail"]=tab.id+"|||"+url;openInCurrent(url)})}function openAllLinks(tx,rs){for(var i=0;i<rs.rows.length;i++){speeddial.storage.trackVisits(rs.rows.item(i).url);chrome.tabs.create({url:rs.rows.item(i).url,selected:false})}}function openAllFromGroup(idGroup){GROUP=idGroup;speeddial.storage.getAllItems(openAllLinks,idGroup)}function moveToGroup(idDial,idGroup){speeddial.storage.moveToGroup(idDial,idGroup,reload)}function reorderBookmarks(){var items=$("#pages li.link");var neworder={};for(var i=0;i<items.length;i++){id=$(items[i]).attr("id");pos=i;speeddial.storage.updateItemOrder(id,pos);neworder[id]=pos}b.sync_order_bookmarks(neworder)}function pagesOnLoad(){var checkWidth=0;var groupsActualWidth=0;var groupsAvailableWidth=$(".groups-container").width();$(".groups-container li").each(function(){groupsActualWidth+=$(this).outerWidth()+2});if(getValue("options.sidebar")==1){$(".sidebar-arrow").show()}$(".groups-more").remove();if(groupsActualWidth>groupsAvailableWidth){groupsAvailableWidth-=100;var a=document.createElement("a");var li=document.createElement("li");var ul=document.createElement("ul");a.innerHTML="&bull;&bull;&bull;";li.setAttribute("class","groups-more");li.appendChild(a);li.appendChild(ul);$(".groups-container > ul").append(li);$(".groups-container > ul > li:not(:last-child)").each(function(){$this=$(this);var position=$(this).position().left+$(this).outerWidth();if(position>groupsAvailableWidth){$(this).appendTo($(".groups-more ul"))}})}$("#groups").addClass("is-shown");$("#groups li").click(function(e){if(SORTINGGROUPS===true){return}if(e.which=="2"){openAllFromGroup($(this).attr("loadgroup"));e.preventDefault();e.stopPropagation();return false}else{GROUP=$(this).attr("loadgroup");if(GROUP){window.location.hash="#"+GROUP;scroll(0,0);if(localStorage["options.keepActiveGroup"]==1){localStorage["options.activeGroup"]=GROUP}$("#groups").removeClass("is-shown");reload()}e.preventDefault();e.stopPropagation();return false}});$(".link").click(function(e){$this=$(this);if(SORTING===true){return false}localStorage["refreshThumbnail"]="";if($this.hasClass("no-thumbnail")||$this.hasClass("no-thumbnail-yet")){speeddial.storage.trackVisits($this.attr("url"));getThumbnail($this.attr("url"),false);e.preventDefault();e.stopPropagation();return false}if(localStorage["options.alwaysNewTab"]==1||localStorage["options.alwaysNewTab"]!="1"&&(isCtrl!=true||e.which!=2)){if(localStorage["options.refreshThumbnails"]>0){if($this.attr("custom_thumbnail")!="true"&&$this.attr("visits")%localStorage["options.refreshThumbnails"]==0){localStorage["refreshThumbnail"]=$this.attr("url")}}}if(e.which!=3){speeddial.storage.trackVisits($this.attr("url"))}if(localStorage["options.alwaysNewTab"]=="1"&&(isCtrl==true||e.which==2)){openInCurrent($this.attr("url"));e.preventDefault();e.stopPropagation()}else if(localStorage["options.alwaysNewTab"]=="1"){chrome.tabs.create({url:$this.attr("url"),selected:true});e.preventDefault()}if(navigator.appVersion.indexOf("Mac")!=-1){if((isCtrl==true||e.which==2)&&localStorage["options.alwaysNewTab"]!=1){openInNew($this.attr("url"));e.preventDefault();e.stopPropagation()}}});$(".link:not(.folder)").contextMenu("editlinkmenu",{onContextMenu:function(e){page_edit_id=$(e.target).attr("rel");return true},bindings:{opennewwindow:function(t){openInNew($(t).attr("url"))},refresh:function(t){getThumbnail($(t).attr("url"),true)},delete:function(t){controller.removeBookmarkDialog($(t).attr("id"))},edit:function(t){controller.editBookmarkDialog($(t).attr("id"))}}});$("#groups li").contextMenu("editgroupmenu",{onContextMenu:function(e){var el=$(e.target).closest("li");var group_id=el.attr("loadgroup");var menu=document.getElementById(this.id);if(!group_id){return false}$(menu).find(".js-home-hide").toggle(group_id!=0);$(menu).find(".js-home-show").toggle(group_id==0);return true},bindings:{editgroup:function(t){controller.editGroupDialog($(t).attr("loadgroup"))},deletegroup:function(t){controller.removeGroupDialog($(t).attr("loadgroup"))},openallgroup:function(t){openAllFromGroup($(t).attr("loadgroup"))}}});$(".app, #appspanel li").not("no-uninstall").contextMenu("editappmenu",{onContextMenu:function(e){$this=$(e.target).parents("li");app_edit_id=$this.attr("rel");if($this.data("uninstall")==false){$("#app_uninstall").hide()}else{$("#app_uninstall").show()}if($this.data("options")!=""){$("#app_options").css("color","#000")}else{$("#app_options").css("color","#999")}return true},bindings:{app_launch:function(t){launchApp($(t).attr("rel"))},app_options:function(t){if($(t).data("options")!=""){openInCurrent($(t).data("options"))}},app_uninstall:function(t){appUninstall($(t).attr("rel"),t)}}});$("#container").contextMenu("newitemmenu",{bindings:{add:function(t){controller.addBookmarkDialog()},create_group:function(t){controller.addGroupDialog()},options:function(t){top.location.href=chrome.extension.getURL("options.html")},statistics:function(t){top.location.href=chrome.extension.getURL("statistics.html")},help:function(t){top.location.href=chrome.extension.getURL("welcome.html")}}});$(".js-new-tab-search").unbind().on("keyup",function(e){$this=$(this);$query=$this.val();if(e.keyCode==27){$this.val("");reload()}else{if($query&&$query.length>1){speeddial.storage.simpleSearch($query)}else{reload()}}});setTimeout(function(){number_of_groups=$("#groups li").length;if(localStorage["options.order"]=="position"){$("#pages").sortable({delay:120,tolerance:"pointer",connectWith:".group",appendTo:"body",placeholder:"pagesplaceholder",forcePlaceholderSize:true,cursor:"move",cursorAt:{left:50,top:-20},start:function(event,ui){SORTING=true;$(ui.item).addClass("beingdragged")},stop:function(event,ui){$(ui.item).removeClass("beingdragged");$(ui.item).css("top",$(ui.item).attr("top"));$(ui.item).css("left",$(ui.item).attr("left"));setTimeout(function(){SORTING=false},200);if(localStorage["options.order"]=="position")reorderBookmarks()}})}if(number_of_groups>0){if(localStorage["options.order"]=="visits"){$("#pages .link").draggable({delay:120,connectWith:".group",cursorAt:{left:50,top:-20},placeholder:"pagesplaceholder",tolerance:"pointer",forcePlaceholderSize:true,cursor:"move",helper:"clone",start:function(event,ui){SORTING=true},stop:function(event,ui){SORTING=false}})}$("#groups").sortable({delay:120,axis:"x",placeholder:"groupsplaceholder",tolerance:"pointer",items:'li:not(".groups-more")',start:function(event,ui){if($(ui.item[0]).parents(".groups-more").length){$(".groups-more").addClass("is-shown")}SORTINGGROUPS=true},stop:function(event,ui){setTimeout(function(){SORTING=false},50);$(".groups-more").removeClass("is-shown");var groups_list=$("#groups li");var neworder={};for(var i=0;i<groups_list.length;i++){neworder[$(groups_list[i]).attr("loadgroup")]=i+1;speeddial.storage.setGroupPosition($(groups_list[i]).attr("loadgroup"),i+1)}b.sync_order_groups(neworder);SORTINGGROUPS=false;return true}});$(".group").droppable({accept:".link",tolerance:"pointer",over:function(event,ui){$(".group").removeClass("hovered");$(this).addClass("hovered")},out:function(event,ui){$(".group").removeClass("hovered")},drop:function(event,ui){var movetogroup=$(this).parent().attr("loadgroup");var item_id=$(ui.draggable).attr("id");if(parseInt(movetogroup)>=0){moveToGroup(item_id,movetogroup);$(ui.draggable).remove()}setTimeout(function(){SORTING=false},50)}})}},10)}$(function(){init();$(".close").click(function(){$(this).parents(".dialog").removeClass("shown")});$("input").attr("autocomplete","off");$("a.ext").attr("target","_blank");$(document).on("click",".openurl",function(e){openurl($(this).attr("rel"),e)});var wiw=window.innerWidth;var wih=window.innerHeight;setTimeout(function(){window.addEventListener("resize",function(){if(Math.abs(window.innerWidth-wiw)>100||Math.abs(window.innerHeight-wih)>100){$("#container").removeClass("is-animated");reload();wiw=window.innerWidth;wih=window.innerHeight}},false)},360)});app.handleFileUpload=function(){return new Promise((resolve,reject)=>{uploader=document.createElement("input");uploader.type="file";uploader.accept=".jpg, .png";uploader.addEventListener("change",function(e){var reader=new FileReader;var file=this.files[0];if(!file){reject("No file selected")}if(file.size>=2500*1024){reject("Sorry, this file too large");return}reader.onload=function(input){controller.state.fileUpload=true;b.upload(input.target.result,false,function(result){if(result.path!=""){resolve(result.path)}else if(r.error!=""){reject("Sorry, this file too large")}})};reader.readAsDataURL(file)});uploader.click()})};$(function(){Vue.component("modal",{template:"#modal-template"});controller=new Vue({el:"#modals",data:{types:{BOOKMARK_ADD:"BOOKMARK_ADD",BOOKMARK_EDIT:"BOOKMARK_EDIT",BOOKMARK_REMOVE:"BOOKMARK_REMOVE",GROUP_ADD:"GROUP_ADD",GROUP_EDIT:"GROUP_EDIT",GROUP_REMOVE:"GROUP_REMOVE"},headings:{BOOKMARK_ADD:i18n("newtab_add_new_dial"),BOOKMARK_EDIT:i18n("newtab_edit_dial"),BOOKMARK_REMOVE:i18n("newtab_remove_question"),GROUP_ADD:i18n("newtab_create_group"),GROUP_EDIT:i18n("newtab_edit_group"),GROUP_REMOVE:i18n("newtab_remove_group")},websites:[],query:"",state:{open:false,type:undefined,fileUpload:false,premium:getValue("options.sync.username")&&getValue("options.sync.password")},group:{},bookmark:{}},computed:{popularWebsitesResult:function(){return this.websites.filter(website=>{return website.title.toLowerCase().indexOf(this.query.toLowerCase())>-1||website.url.indexOf(this.query.toLowerCase())>-1})}},methods:{dismiss:function(){this.state.open=false},open:function(){this.state.open=true},onOverlayClick:function(e){if(e.target.className=="modal__wrapper"){this.dismiss()}},setView:function(view){this.state.view=view;this.state=Object.assign({},this.state)},upgradeToPro:function(){top.location.href=chrome.extension.getURL("options.html#tab-sync")},suggestBookmarkTitle:function(){if(!this.bookmark.title||!this.bookmark.id){var suggest_name=this.bookmark.url;suggest_name=suggest_name.replace("http://","").replace("https://","").replace(".org","").replace(".com","").replace(".net","").replace("www.","").replace("/"," ");this.bookmark.title=suggest_name.charAt(0).toUpperCase()+suggest_name.slice(1);this.bookmark=Object.assign({},this.bookmark)}},suggestBookmarkLogo:function(){var logo=new Image;var hostname=getHostname(fixUrl(this.bookmark.url));var logoSrc="https://logo.clearbit.com/"+hostname+"?size=320";if(!hostname)return;logo.addEventListener("load",()=>{if(!this.bookmark.id){this.bookmark.thumbnailSource="logo"}if(this.bookmark.thumbnail==logoSrc){this.bookmark.thumbnailSource="logo"}this.bookmark.logo=logoSrc;this.bookmark=Object.assign({},this.bookmark)});logo.addEventListener("error",()=>{this.bookmark.logo=undefined;if(this.bookmark.thumbnailSource=="logo"){this.bookmark.thumbnailSource="capture"}this.bookmark=Object.assign({},this.bookmark)});logo.src=logoSrc},onUrlBlur:function(){if(!this.bookmark.url)return;this.suggestBookmarkTitle();this.suggestBookmarkLogo()},setThumbnailSource:function(source){this.bookmark.thumbnailSource=source;this.bookmark=Object.assign({},this.bookmark)},uploadThumbnail:function(){if(this.bookmark.upload){this.bookmark.thumbnailSource="upload";return}if(!this.state.premium){this.bookmark.thumbnailSource="upload";return}app.handleFileUpload().then(result=>{this.bookmark.upload=result;this.bookmark.thumbnailSource="upload";this.state.fileUpload=false;this.bookmark=Object.assign({},this.bookmark)}).catch(error=>{show_message(error);this.bookmark.upload=undefined;this.state.fileUpload=false;this.bookmark=Object.assign({},this.bookmark)})},toggleWebsite:function(item){item.selected=!item.selected;this.websites=clone(this.websites)},submit:function(){switch(this.state.type){case this.types["BOOKMARK_ADD"]:if(this.state.view!="popular"){this.createBookmark()}else{this.createBookmarksFromPopular()}break;case this.types["BOOKMARK_EDIT"]:this.updateBookmark();break;case this.types["BOOKMARK_REMOVE"]:this.deleteBookmark();break;case this.types["GROUP_ADD"]:this.createGroup();break;case this.types["GROUP_EDIT"]:this.updateGroup();break;case this.types["GROUP_REMOVE"]:this.deleteGroup();break}},addBookmarkDialog:function(){this.state.type=this.types["BOOKMARK_ADD"];this.state.view=null;this.query="";if(typeof BOOKMARKS_COUNT!="undefined"&&BOOKMARKS_COUNT==0){this.state.view="popular"}this.websites=clone(app.suggestedWebsites);this.bookmark={};this.open();setTimeout(()=>{this.$refs.url&&this.$refs.url.focus()})},editBookmarkDialog:function(id){this.state.type=this.types["BOOKMARK_EDIT"];this.state.view=null;this.websites=clone(app.suggestedWebsites);speeddial.storage.getItem(id,(_,result)=>{if(!result)return;this.bookmark={id:result.rows.item(0).id,url:decodeURI(result.rows.item(0).url),title:result.rows.item(0).title,idgroup:result.rows.item(0).idgroup,thumbnail:result.rows.item(0).thumbnail?decodeURI(result.rows.item(0).thumbnail):""};if(this.bookmark.thumbnail){this.bookmark.thumbnailSource="url"}else{this.bookmark.thumbnailSource="capture"}this.open();this.suggestBookmarkLogo();setTimeout(()=>{this.$refs.url&&this.$refs.url.focus()})})},removeBookmarkDialog:function(id){this.state.type=this.types["BOOKMARK_REMOVE"];this.state.view=null;speeddial.storage.getItem(id,(_,result)=>{if(!result)return;this.bookmark={id:result.rows.item(0).id,thumbnail:result.rows.item(0).thumbnail,url:result.rows.item(0).url};this.open()})},addGroupDialog:function(){this.state.type=this.types["GROUP_ADD"];this.state.view=null;this.group={};this.open();setTimeout(()=>{this.$refs.title&&this.$refs.title.focus()})},editGroupDialog:function(id){this.state.type=this.types["GROUP_EDIT"];this.state.view=null;if(id==0){this.group={id:0,title:localStorage["options.defaultGroupName"]};this.open()}else{speeddial.storage.getGroup(id,(_,result)=>{if(!result)return;this.group={id:result.rows.item(0).id,title:result.rows.item(0).title};this.open();setTimeout(()=>{this.$refs.title&&this.$refs.title.focus()})})}},removeGroupDialog:function(id){this.state.type=this.types["GROUP_REMOVE"];this.state.view=null;this.group={id:id};this.open()},createBookmark:function(){var data={url:fixUrl(this.bookmark.url),title:this.bookmark.title,thumbnail:this.bookmark.thumbnail,ts_created:Math.floor(Date.now()/1e3),idgroup:GROUP||0,position:999};if(data.url){data.url=data.url.trim()}if(data.title){data.title=data.title.trim()}if(data.thumbnail){data.thumbnail=data.thumbnail.trim()}if(!data.title||!data.url){show_message(i18n("newtab_add_dial_error"));return false}if(data.url.indexOf("%")==-1){data.url=encodeURI(data.url)}if(data.thumbnail&&data.thumbnail.indexOf("%")==-1){data.thumbnail=encodeURI(data.thumbnail)}if(this.bookmark.thumbnailSource=="logo"&&this.bookmark.logo){data.thumbnail=this.bookmark.logo}if(this.bookmark.thumbnailSource=="upload"&&this.bookmark.upload){data.thumbnail=this.bookmark.upload}if(this.bookmark.thumbnailSource=="capture"){data.thumbnail=""}speeddial.storage.analytics("created-bookmark");speeddial.storage.addItem(data,()=>{reload();this.dismiss()})},createBookmarksFromPopular:function(){var selected=this.websites.filter(function(website){return website.selected==true});if(!selected.length){return}for(var i=0;i<selected.length;i++){var website=selected[i];(()=>{var data={url:website.url,title:website.title,thumbnail:website.logo,ts_created:Math.floor(Date.now()/1e3),idgroup:GROUP||0,position:999};speeddial.storage.addItem(data,()=>{if(selected.indexOf(website)==selected.length-1){reload();controller.dismiss()}})})(website)}},updateBookmark:function(){speeddial.storage.getItem(this.bookmark.id,(_,result)=>{if(!result)return;var previousModel=result.rows.item(0);var clearVisitsData=false;var data={id:this.bookmark.id,url:fixUrl(this.bookmark.url),title:this.bookmark.title,thumbnail:this.bookmark.thumbnail,idgroup:this.bookmark.idgroup};if(data.url){data.url=data.url.trim()}if(data.title){data.title=data.title.trim()}if(data.thumbnail){data.thumbnail=data.thumbnail.trim()}if(!data.id||!data.title||!data.url){show_message(i18n("newtab_add_dial_error"));return false}if(data.url.indexOf("%")==-1){data.url=encodeURI(data.url)}if(data.thumbnail&&data.thumbnail.indexOf("%")==-1){data.thumbnail=encodeURI(data.thumbnail)}if(this.bookmark.thumbnailSource=="logo"&&this.bookmark.logo){data.thumbnail=this.bookmark.logo}if(this.bookmark.thumbnailSource=="upload"&&this.bookmark.upload){data.thumbnail=this.bookmark.upload}if(this.bookmark.thumbnailSource=="capture"){data.thumbnail=""}if(previousModel.url!=this.bookmark.url){speeddial.storage.removeThumbnail(previousModel.url);clearVisitsData=true}if(previousModel.thumbnail==""&&this.bookmark.thumbnail){speeddial.storage.removeThumbnail(previousModel.url)}console.log(data);speeddial.storage.editItem(data,clearVisitsData,(_,result)=>{speeddial.storage.analytics("edited-bookmark");show_message(i18n("newtab_dial_saved"));reload();this.dismiss()})})},deleteBookmark:function(){speeddial.storage.deleteItem(this.bookmark.id,()=>{speeddial.storage.analytics("removed-bookmark");speeddial.storage.removeThumbnail(this.bookmark.url);reload();this.dismiss()})},createGroup:function(){var data={title:this.group.title};if(!data.title){show_message(i18n("newtab_enter_group_name"));return false}speeddial.storage.analytics("created-group");speeddial.storage.addGroup(data,(_,result)=>{if(result&&result.insertId){GROUP=result.insertId;if(localStorage["options.keepActiveGroup"]==1){localStorage["options.activeGroup"]=GROUP}}reload();this.dismiss()})},updateGroup:function(){var data={id:this.group.id,title:this.group.title};if(!data.title){show_message(i18n("newtab_enter_group_name"));return false}if(this.group.id==0){localStorage["options.defaultGroupName"]=this.group.title;reload();this.dismiss()}else{speeddial.storage.analytics("edited-group");speeddial.storage.editGroup(data,true,(_,result)=>{reload();this.dismiss()})}},deleteGroup:function(){if(GROUP==this.group.id){GROUP=0;if(localStorage["options.keepActiveGroup"]==1){localStorage["options.activeGroup"]=0}window.location.hash=""}speeddial.storage.analytics("removed-group");speeddial.storage.deleteGroup(this.group.id);show_message(i18n("newtab_group_removed"));this.dismiss()}}});app.optionsController=new Vue({el:"#options-modal",data:{state:{open:false,synchronizing:false,premium:getValue("options.sync.username")&&getValue("options.sync.password"),lastSync:moment.unix(parseInt(getValue("options.sync.lastsync"))).fromNow()||null},columns:getValue("options.columns"),spacing:getValue("options.dialspacing"),width:getValue("options.dialSpace"),center:getValue("options.centerVertically")==1,plusButton:getValue("options.showAddButton")==1,darkTheme:getValue("options.darkTheme")==1},watch:{columns:function(value){setValue("options.columns",value);reload()},spacing:function(value){setValue("options.dialspacing",value);reload()},width:function(value){setValue("options.dialSpace",value);reload()},center:function(value){setValue("options.centerVertically",value?1:0);reload()},plusButton:function(value){setValue("options.showAddButton",value?1:0);reload()},darkTheme:function(value){setValue("options.darkTheme",value?1:0);if(value){document.body&&document.body.classList.add("theme--dark")}else{document.body&&document.body.classList.remove("theme--dark")}}},methods:{dismiss:function(){this.state.open=false;b.sync_settings()},loadSettings:function(){this.columns=getValue("options.columns");this.spacing=getValue("options.dialspacing");this.width=getValue("options.dialSpace");this.center=getValue("options.centerVertically")==1;this.plusButton=getValue("options.showAddButton")==1;this.darkTheme=getValue("options.darkTheme")==1;this.state.premium=getValue("options.sync.username")&&getValue("options.sync.password");this.state.lastSync=moment.unix(parseInt(getValue("options.sync.lastsync"))).fromNow()||null},open:function(){this.state.open=true;this.state.groupsCount=GROUPS_COUNT||0},sync:function(){this.state.synchronizing=true;b.sync(()=>{this.state.synchronizing=false;if(localStorage.getItem("options.sync.lastsync")){this.state.lastSync=moment.unix(parseInt(getValue("options.sync.lastsync"))).fromNow()||null}this.loadSettings();reload()})},onOverlayClick:function(e){if(e.target.className=="modal__wrapper"){this.dismiss()}}}})});$(function(){if(getValue("options.darkTheme")==1){document.body&&document.body.classList.add("theme--dark");$("#container").on("scroll",function(e){$("body").toggleClass("body--scrolled",e.target.scrollTop>32)})}});var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-1391454-40"]);_gaq.push(["_setSampleRate","10"]);_gaq.push(["_setCustomVar",1,"User-type",localStorage["options.sync.password"]&&localStorage["options.sync.username"]?"Pro":"Regular",1]);_gaq.push(["_setCustomVar",2,"Using Groups",localStorage["sys.groups"]>0?"Yes":"No",1]);_gaq.push(["_setCustomVar",3,"Using Sidebar",localStorage["options.sidebar"]==1?"Yes":"No",1]);_gaq.push(["_setCustomVar",4,"Using Apps",localStorage["options.apps.show"]==1?"Yes":"No",1]);_gaq.push(["_setCustomVar",5,"Dark theme",localStorage["options.darkTheme"]==1?"Yes":"No",1]);_gaq.push(["_trackPageview"]);(function(){var ga=document.createElement("script");ga.type="text/javascript";ga.async=true;ga.src="https://stats.g.doubleclick.net/dc.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga,s)})();speeddial.storage.analytics("opens");