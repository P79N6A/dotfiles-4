var b;chrome.runtime.getBackgroundPage(function(Window){b=Window;b.getGroups(function(response){groups=response;if(groups&&groups.length>0){var listOfGroups=$("body").find(".add-to-group");for(var i=0;i<groups.length;i++){var li=$("<li />");var link=$("<a />");link.data("group",groups[i].id);link.html(groups[i].title);link.appendTo(li);li.appendTo(listOfGroups)}var height=$("body").height();$("html").css("min-height",height);$("body").css("min-height",height)}else{addCurrentPage(0)}})});function addCurrentPage(group){$(".add-to-group").remove();$(".create-new-group").remove();$("body").removeClass("is-create-new-group");$("html").css("min-height","46px");$("body").css("min-height","46px");$("html").css("height","46px");$("body").css("height","46px");$("h1").text("Saving to Speed Dial...").addClass("loading");setTimeout(function(){b.addCurrentPage(group,function(){$("h1").text("Page saved!").addClass("success");setTimeout(function(){self.close()},1e3)})},600)}$(function(){$(document).on("click",".add-to-group a",function(){addCurrentPage($(this).data("group"))});$(document).on("click","h1 a",function(){chrome.tabs.create({url:chrome.extension.getURL("options.html"),selected:true})});$(document).on("click",".js-create-group",function(){$("html").css("min-height","166px");$("body").css("min-height","16px");$("html").css("height","166px");$("body").css("height","166px");$("body").addClass("is-create-new-group");$("form input").focus()});$(document).on("submit","form",function(e){e.preventDefault();e.stopPropagation();group={title:$("form input[type=text]").val(),color:"FFFFFF"};if(!group.title){return}b.create_group(group,function(tx,rs){if(rs.insertId){addCurrentPage(rs.insertId)}})})});